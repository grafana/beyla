# this file is actually a Go template that needs to be processed before deploying
# Mandatory variables are PodName and TargetURL
apiVersion: v1
kind: Pod
metadata:
  name: "{{.PodName}}"
  labels:
    component: pinger
  annotations:
    resource.opentelemetry.io/deployment.environment: 'to-be-ignored-in-favor-of-env-var'
spec:
  shareProcessNamespace: true
  serviceAccountName: beyla
  volumes:
    - name: configs
      persistentVolumeClaim:
        claimName: configs

  containers:
    - name: pinger
      image: httppinger:dev
      env:
        - name: TARGET_URL
          value: "{{.TargetURL}}"
        - name: OTEL_RESOURCE_ATTRIBUTES
          value: "deployment.environment=integration-test,service.version=3.2.1"
